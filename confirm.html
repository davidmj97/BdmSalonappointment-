<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Confirm Booking - BDM Salon</title>
<style>
:root {
  --bg: #000;
  --fg: #fff;
  --accent: linear-gradient(135deg, #1a237e 0%, #0d47a1 100%);
  --card-bg: #111;
  --card-border: #333;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Helvetica Neue', Arial, sans-serif;
  background: var(--bg);
  color: var(--fg);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  padding-top: 150px; /* Space for fixed header */
}

/* Fixed Header - Matching Step 4 */
.header-container {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: #000;
  z-index: 100;
  padding: 15px 0;
  box-shadow: 0 2px 10px rgba(0,0,0,0.5);
}

.step-heading {
  text-align: center;
  margin: 5px 0 15px;
  font-size: 20px;
  color: white;
}

.btn-container {
  display: flex;
  gap: 16px;
  margin: 0 16px;
  padding: 0;
}

.btn-prev,
.confirm-btn {
  flex: 1;
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-prev {
  background: #444;
  color: #fff;
}

.confirm-btn {
  background: var(--accent);
  color: white;
}

/* Main Container */
.container {
  flex: 1;
  padding: 30px 20px;
  display: flex;
  flex-direction: column;
  max-width: 800px;
  margin: 0 auto;
  width: 100%;
}

/* Booking Card */
.booking-card {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 30px;
  border: 1px solid var(--card-border);
  box-shadow: 极 10px 30px rgba(0,0,0,0.3);
}

.booking-section {
  margin-bottom: 30px;
}

.section-title {
  font-size: 18px;
  margin-bottom: 20px;
  color: #bbb;
  position: relative;
  padding-bottom: 10px;
}

.section-title::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 50px;
  height: 2px;
  background: linear-gradient(90deg, #1a237e, #0d47a1);
  border-radius: 2px;
}

.booking-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

.booking-item {
  background: #1a1a1a;
  border-radius: 10px;
  padding: 15px;
}

.item-label {
  font-size: 14px;
  color: #999;
  margin-bottom: 8px;
}

.item-value {
  font-size: 16px;
  font-weight: 500;
}

/* Service item styling */
.service-item {
  background: #222;
  border-radius: 8px;
  padding: 12px;
  margin-bottom: 10px;
}

.service-property {
  display: flex;
  justify-content: space-between;
  margin-bottom: 5px;
}

.service-name {
  font-weight: 600;
}

/* Mobile adjustments */
@media (max-width: 900px) {
  body {
    padding-top: 140px;
  }
  
  .container {
    padding: 20px 10px;
  }
  
  .booking-card {
    padding: 20px;
  }
  
  .booking-grid {
    grid-template-columns: 1fr;
  }
}

/* Hide scrollbar */
::-webkit-scrollbar {
  display: none;
}
</style>
</head>
<body>

<!-- Fixed Header - Matching Step 4 -->
<div class="header-container">
  <h1 class="step-heading">Step 5: Confirm Booking</h1>
  
  <!-- Navigation Buttons -->
  <div class="btn-container">
    <button class="btn-prev" onclick="window.history.back()">Back</button>
    <button class="confirm-btn" id="confirmBtn">Confirm and Book Appointment</button>
  </div>
</div>

<!-- Main Container -->
<div class="container">
  <!-- Booking Details Card -->
  <div class极="booking-card">
    <!-- Service Section -->
    <div class="booking-section">
      <h2 class="section-title">Service Details</h2>
      <div id="servicesContainer">
        <!-- Services will be inserted here via JavaScript -->
      </div>
    </div>
    
    <!-- Stylist Section -->
    <div class="booking-section">
      <h2 class="section-title">Stylist</h2>
      <div class="booking-grid">
        <div class="booking-item">
          <div class="item-label">Stylist</div>
          <div class="item-value" id="stylistValue"></div>
        </div>
        <div class="booking-item">
          <div class="item-label">Specialty</div>
          <div class="item-value" id="stylistSpecialty"></div>
        </div>
      </div>
    </div>
    
    <!-- Date & Time Section -->
    <div class="booking-section">
      <h2 class="section-title">Date & Time</h2>
      <div class="booking-grid">
        <div class="booking-item">
          <div class="item-label">Date</div>
          <div class="item-value" id="dateValue"></div>
        </div>
        <div class="booking-item">
          <div class="item-label">Time</div>
          <div class="item-value" id="timeValue"></div>
        </div>
        <div class="booking-item">
          <div class="item-label">Location</div>
          <div class="item-value">BDM Salon, Main Street</div>
        </div>
      </div>
    </div>
    
    <!-- Personal Details Section -->
    <div class="booking-section">
      <h2 class="section-title">Personal Details</h2>
      <div class="booking-grid">
        <div class="booking-item">
          <div class="item-label">Name</div>
          <div class="item-value" id="nameValue"></div>
        </div>
        <div class="booking-item">
          <div class="item-label">Phone</div>
          <div class="item-value" id="phoneValue"></div>
        </div>
        <div class="booking-item">
          <div class="item-label">Email</div>
          <div class="item-value" id="emailValue"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// DOM Elements
const servicesContainer = document.getElementById('servicesContainer');
const stylistValue = document.getElementById('stylistValue');
const stylistSpecialty = document.getElementById('stylistSpecialty');
const dateValue = document.getElementById('dateValue');
const timeValue = document.getElementById('timeValue');
const nameValue = document.getElementById('nameValue');
const phoneValue = document.getElementById('phoneValue');
const emailValue = document.getElementById('emailValue');
const confirmBtn = document.getElementById('confirmBtn');

// Load booking details from localStorage
const loadBookingDetails = () => {
  console.log("Loading booking details from localStorage...");
  
  // Service details - multiple services
  const servicesData = localStorage.getItem('selectedServices');
  if (servicesData) {
    try {
      const services = JSON.parse(servicesData);
      console.log("Service data:", services);
      
      // Clear previous services
      servicesContainer.innerHTML = '';
      
      // Render each service
      services.forEach(service => {
        const serviceItem = document.createElement('div');
        serviceItem.classList.add('service-item');
        serviceItem.innerHTML = `
          <div class="service-property">
            <span class="service-name">${service.name || "Not selected"}</span>
            <span>${service.price || "Not selected"}</span>
          </div>
          <div class="service-property">
            <span>Duration:</span>
            <span>${service.time || "Not selected"}</span>
          </div>
          <div class="service-property">
            <span>Points:</span>
            <span>${service.points || "Not selected"}</span>
          </div>
        `;
        servicesContainer.appendChild(serviceItem);
      });
    } catch (e) {
      console.error("Error parsing service data:", e);
      servicesContainer.innerHTML = '<div class="booking-item">Error loading services</div>';
    }
  } else {
    console.warn("No service data found in localStorage");
    servicesContainer.innerHTML = '<div class="booking-item">No services selected</div>';
  }
  
  // Stylist details
  const stylistData = localStorage.getItem('selectedStylist');
  if (stylistData) {
    try {
      const stylist = JSON.parse(stylistData);
      console.log("Stylist data:", stylist);
      stylistValue.textContent = stylist.name || "Not selected";
      stylistSpecialty.textContent = stylist.specialty || "Not specified";
    } catch (e) {
      console.error("Error parsing stylist data:", e);
      stylistValue.textContent = "Error loading stylist";
      stylistSpecialty.textContent = "Error loading specialty";
    }
  } else {
    console.warn("No stylist data found in localStorage");
    stylistValue.textContent = "Not selected";
    stylistSpecialty.textContent = "Not specified";
  }
  
  // Date and time - FIXED DATE DISPLAY
  const selectedDate = localStorage.getItem('selectedDate');
  if (selectedDate) {
    // Parse date string and format manually
    const dateParts = selectedDate.split('-');
    const year = dateParts[0];
    const month = dateParts[1];
    const day = dateParts[2];
    
    // Month names array
    const monthNames = [
      "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];
    
    // Weekday names array
    const weekdayNames = [
      "Sunday", "Monday", "Tuesday", "Wednesday", 
      "Thursday", "Friday", "Saturday"
    ];
    
    // Create date object in UTC to avoid timezone issues
    const dateObj = new Date(Date.UTC(
      parseInt(year),
      parseInt(month),
      parseInt(day)
    ));
    
    // Get weekday index (0=Sunday, 6=Saturday)
    const weekdayIndex = dateObj.getUTCDay();
    
    // Format date manually
    const formattedDate = `${weekdayNames[weekdayIndex]}, ${monthNames[parseInt(month)-1]} ${parseInt(day)}, ${year}`;
    
    dateValue.textContent = formattedDate;
  } else {
    console.warn("No date found in localStorage");
    dateValue.textContent = "Not selected";
  }
  
  const selectedTime = localStorage.getItem('selectedTime');
  if (selectedTime) {
    console.log("Selected time:", selectedTime);
    timeValue.textContent = selectedTime;
  } else {
    console.warn("No time found in localStorage");
    timeValue.textContent = "Not selected";
  }
  
  // Personal details
  const userDetails = localStorage.getItem('userDetails');
  if (userDetails) {
    try {
      const user = JSON.parse(userDetails);
      console.log("User details:", user);
      nameValue.textContent = user.name || "Not provided";
      phoneValue.textContent = user.phone || "Not provided";
      emailValue.textContent = user.email || "Not provided";
    } catch (e) {
      console.error("Error parsing user details:", e);
      nameValue.textContent = "Error loading name";
      phoneValue.textContent = "Error loading phone";
      emailValue.textContent = "Error loading email";
    }
  } else {
    console.warn("No user details found in localStorage");
    nameValue.textContent = "Not provided";
    phoneValue.textContent = "极 provided";
    emailValue.textContent = "Not provided";
  }
  
  // Log all localStorage contents for debugging
  console.log("All localStorage contents:");
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    console.log(`${key}: ${localStorage.getItem(key)}`);
  }
};

// Handle booking confirmation
const confirmBooking = () => {
  // Collect all booking data
  const bookingData = {
    services: localStorage.getItem('selectedServices'),
    stylist: localStorage.getItem('selectedStylist'),
    date: localStorage.getItem('selectedDate'),
    time: localStorage.getItem('selectedTime'),
    user: localStorage.getItem('userDetails')
  };
  
  // Show success message
  alert('Your appointment has been booked successfully!');
  
  // Clear booking data from localStorage
  localStorage.removeItem('selectedServices');
  localStorage.removeItem('selectedService');
  localStorage.removeItem('selectedStylist');
  localStorage.removeItem('selectedDate');
  localStorage.removeItem('formattedDate');
  localStorage.removeItem('selectedTime');
  localStorage.removeItem('userDetails');
  
  // Redirect to home page
  window.location.href = 'index.html';
};

// Set up event listeners
confirmBtn.addEventListener('click', confirmBooking);

// Initialize page
window.addEventListener('DOMContentLoaded', loadBookingDetails);
</script>
</body>
</html>
